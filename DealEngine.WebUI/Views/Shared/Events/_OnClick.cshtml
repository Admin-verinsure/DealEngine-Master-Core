<script type="text/javascript">
    function OnClick(Method, Type, Id, SheetId) {
        if (Type == "Organisation") {
            $.ajax({
                url: '@Url.Action("GetOrganisation", "Services")',
                type: "POST",
                data: { ID: Id, AnswerSheetId: SheetId },
                success: function (Data) {
                    try {
                        var OutPut = JSON.parse(Data);
                        PopulateOrganisationView(OutPut);
                    } catch (e) {
                        debugger;
                    }
                }, error: function (request, error) {
                    debugger;
                }
            });
            EditOrganisation();
        }
    }

    function EditOrganisation() {
        CloneForm("OrganisationTab3", "OrganisationTab2", "OrganisationSubmitBtn", "OrganisationClearButton");
    }

    function RemoveOrganisation(organisationId, AccordionId) {
        sessionStorage.setItem('accordianTrigger', AccordionId);
        $.ajax({
            url: '@Url.Action("RemoveOrganisation", "Services")',
            type: "POST",
            data: { OrganisationId: organisationId },
            success: function (Data) {
                try {
                    location.reload();
                } catch (e) {
                    debugger;
                }
            }, error: function (request, error) {
                debugger;
            }
        });
    }

    function RestoreOrganisation(organisationId, AccordionId) {
        sessionStorage.setItem('accordianTrigger', AccordionId);
        $.ajax({
            url: '@Url.Action("RestoreOrganisation", "Services")',
            type: "POST",
            data: { OrganisationId: organisationId },
            success: function (Data) {
                try {
                    location.reload();
                } catch (e) {
                    debugger;
                }
            }, error: function (request, error) {
                debugger;
            }
        });
    }

    function CloneForm(AddTabId, EditTabId, AddButtonId, CancelButtonId) {
        var editTabHTML = document.getElementById(EditTabId);
        var addTabHTML = document.getElementById(AddTabId);
        editTabHTML.innerHTML = addTabHTML.innerHTML;
        addTabHTML.innerHTML = "";
        document.getElementById(AddButtonId).innerText = "Update";
        document.getElementById(CancelButtonId).innerText = "Cancel Update";
        SetCurrentTab(EditTabId);
    }

    function ImportValue(Element, Value) {
        if (Element.tagName == "INPUT") {
            if (Element.type == "date") {
                //hardcord date string
                var date = Value.substring(0, 10);
                Element.value = date;
            }
            else {
                if (Value == "project management personnel") {
                    Value = "ProjectPersonnel";
                }
                Element.value = Value;
            }
        }
        else if (Element.tagName == "SELECT") {
            //debugger;
            for (var o = 0; o < Element.options.length; o++) {
                if (Element.options[o].value == Value.toString()) {
                    Element.options[o].selected = true;
                    break;
                }
            }
        }
    }
    
</script>