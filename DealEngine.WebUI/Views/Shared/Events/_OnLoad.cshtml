<script type="text/javascript">

    //intialize objects on load
    var d = new Date();
    var currMonth = d.getMonth();
    var currYear = d.getFullYear();
    var currDate = d.getDate();

    if (currMonth < 8) {
        currMonth = 8;
        var startDate = new Date(currYear, currMonth, 1);
    } else {
        var startDate = new Date(currYear, currMonth, currDate);
    }

    $('#FAPCoverStartDate').datepicker({
        dateFormat: "dd/mm/yy",
        minDate: startDate
    });

    function PopulateOrganisationView(Method, OutPut) {
        try {
            var Form = document.getElementById("organisationViewModel");
            var TradingName = document.getElementById("NoTradingName");
            var Unit = document.getElementsByName("Unit");
            if (TradingName != null) {
                TradingName.value = false;
            }
            for (obj in OutPut) {
                var model = OutPut[obj];
                var Type = obj;
                for (var Field in model) {
                    var Element = null;
                    var Value = "";

                    if (model.hasOwnProperty("InsuranceAttributes")) {
                        if (Field === "InsuranceAttributes") {
                            var Id = Type + ".InsuranceAttribute";
                            Value = OutPut[obj][Field]["0"]["Name"];
                            Element = document.getElementById(Id);
                            PopulateOrganisationalUnit(OutPut, Unit[0].id);
                        }
                    }

                    if (Element == null) {
                        var Id = Type + "." + Field;
                        Element = document.getElementById(Id);
                        Value = OutPut[obj][Field];
                    }
                    if (Element != null) {
                        if (Element.tagName == "INPUT") {
                            if (Element.type == "date") {
                                //hardcord date string
                                var date = Value.substring(0, 10);
                                if (date == "0001-01-01") {
                                  element.value = null;
                                } else {
                                  element.value = date;
                                }
                            }
                            else {
                                Element.value = Value;
                            }
                        }
                        else if (Element.tagName == "SELECT") {
                            for (var o = 0; o < Element.options.length; o++) {
                                if (Element.options[o].value == Value.toString()) {
                                    Element.options[o].selected = true;
                                    break;
                                }
                            }
                        }
                        OnChange(Element.id, Element.name);
                    }
                    else {
                        //unfound html ids are here
                    }
                }
                if (Method == "Owner") {
                    debugger;
                    var ProgrammeName = document.getElementById("Programme_Name");
                    if (ProgrammeName.value == "NZPI Programme") {
                        NZPIOwnerOnLoad();
                    }
                    if (ProgrammeName.value == "TripleA Programme" || ProgrammeName.value == "NZFSG Programme") {
                        AdvisorOwnerOnLoad();
                    }

                    document.getElementById("HideOrganisationType").hidden = true;
                    document.getElementById("HideInsuranceAttribute").hidden = true;
                    document.getElementById("Organisation.OrganisationType").disabled = true;
                    document.getElementById("Organisation.InsuranceAttribute").disabled = true;                    
                    document.getElementById("Else").hidden = false;
                }
            }
        } catch (ex) { debugger; }
    }

    function AdvisorOwnerOnLoad() {
        var TradingName = document.getElementById("NoTradingName");
        if (TradingName != null) {
            document.getElementById("TradingName").hidden = false;
        }
    }

    function PopulateOrganisationalUnit(OutPut, UnitName) {
        for (var Unit in OutPut["Organisation"]["OrganisationalUnits"]) {
            for (var Item in OutPut["Organisation"]["OrganisationalUnits"][Unit]) {
                id = UnitName + "." + Item;
                var element = document.getElementById(id);
                if (element != null) {
                    var Value = OutPut["Organisation"]["OrganisationalUnits"][Unit][Item];
                    if (element.tagName == "INPUT") {
                        if (element.type == "date") {
                            //hardcord date string
                            debugger;
                            var date = Value.substring(0, 10);
                            if (date == "0001-01-01") {
                                  element.value = null;
                                } else {
                                  element.value = date;
                                }
                            //element.value = date;
                        }
                        else {
                            element.value = Value;
                        }
                    }
                    else if (element.tagName == "SELECT") {
                        if (Value == "1") {
                            Value = "true"
                        }
                        else if (Value == "2") {
                            Value = "false";
                        }
                        for (var o = 0; o < element.options.length; o++) {
                            if (element.options[o].value == Value.toString()) {
                                element.options[o].selected = true;
                                break;
                            }
                        }
                    }
                    OnChange(element.id, element.name);
                }
            }
        }
    }

</script>