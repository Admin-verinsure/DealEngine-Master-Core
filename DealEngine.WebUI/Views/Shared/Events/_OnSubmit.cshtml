<script type="text/javascript">
    function OnOrganisationSubmit(FormId, AccordionId) {
        var PostAjax = true;
        var RemoveAdvisors = false;
        var form = document.getElementById(FormId);
        if (FormId === "organisationViewModel") {
            for (var i = 0; i < form.length; i++) {
                try {
                    if (form[i].id != "") {
                        var element = document.getElementById(form[i].id);
                        OnChange(element.id, element.name);
                        var dataRule = element.getAttribute('data-rule');
                        if (dataRule == "PrincipalAdvisor") {                            
                            if (element[element.selectedIndex].value == "true") {                                
                                RemoveAdvisors = true;
                            }
                        }
                        var IsHidden = IsElementHidden(element);
                        if (element.classList.contains("is-invalid") && (IsHidden != true)) {
                            PostAjax = false;
                            //write a message here or stop the process
                            debugger;
                            throw element.id + " incomplete";
                        }
                    }
                }
                catch (ex) {
                    debugger;
                    PostAjax = false;
                    console.log(ex, element.Name);
                    event.preventDefault();
                    event.stopPropagation();
                }
            }
        }
        if (PostAjax) {
            try {
                sessionStorage.setItem('accordianTrigger', AccordionId);
                if (RemoveAdvisors) {
                    $.ajax({
                        url: '@Url.Action("RemovePrincipalAdvisors", "Organisation")',
                        type: "POST",
                        async: false,
                        data: $("#" + form.id).serialize(),
                        error: function (request, error) {
                            debugger;
                        }
                    });
                }
                $.ajax({
                    url: '@Url.Action("AddOrganisation", "Organisation")',
                    type: "POST",
                    async: false,
                    data: $("#" + form.id).serialize(),
                    success: function (Data) {
                        form.reset();
                        location.reload();
                    }, error: function (request, error) {
                        debugger;
                    }
                });
            }
            catch (ex) {
                debugger;
                console.log(ex, element.Name);
            }


        }
        else {
            window.alert("Please complete the form");
        }
    }

</script>