@model DealEngine.WebUI.Models.InformationViewModel

<div id="AddOrganisation">
    <ul class="nav nav-tabs" role="tablist">
        <li class="nav-item" id="tab1">
            <a class="nav-link active" href="#OrganisationTab1" data-toggle="tab"> List All </a>
        </li>
        <li class="nav-item" id="tab2">
            <a class="nav-link" href="#OrganisationTab2" data-toggle="tab"> Edit </a>
        </li>
        <li class="nav-item" id="tab3">
            <a class="nav-link" href="#OrganisationTab3" data-toggle="tab"> Add </a>
        </li>
        <li class="nav-item" id="tab4">
            <a class="nav-link" href="#OrganisationTab4" data-toggle="tab"> Removed </a>
        </li>
    </ul>
    <div class="tab-content">
        <div id="OrganisationTab1" class="tab-pane active" role="tabpanel">
            <table id="tblLocation"
                   class="table table-striped" width="100%"
                   data-show-columns="true"
                   data-pagination="true"
                   data-search="true"
                   data-show-jump-to="true">
                <thead>
                    <tr>
                        <th data-field="editButton" data-sortable="false"></th>
                        <th data-field="OrganisationName" data-sortable="true">Organisation Name</th>
                        <th data-field="OrganisationType" data-sortable="true">Organisation Type</th>
                        <th data-field="IsPrincipal" data-sortable="true">Is Principal</th>
                        <th data-field="deleteButton" data-sortable="false"></th>
                    </tr>
                </thead>
                <tbody>
                    @foreach (var organisation in Model.OrganisationViewModel.Organisations.Where(o => o.Id == Model.ClientInformationSheet.Owner.Id).ToList())
                    {
                        <tr id="@organisation.Id">
                            <td>
                                <button class="btn btn-success btn-sm" onclick="OnClick('Get', 'Organisation', '@organisation.Id', '@Model.ClientInformationSheet.Id')"><i class="fa fa-edit"></i> Edit</button>
                            </td>
                            <td>
                                @organisation.Name
                            </td>
                            <td>
                                Owner
                            </td>
                            <td>                                
                            </td>
                            <td>
                                <button onclick="RemoveLocation('@organisation.Id')" type="button" class=" btn btn-danger btn-sm" id="trash"><span class="fa fa-trash"></span></button>
                            </td>
                        </tr>
                    }
                    @foreach (var organisation in Model.OrganisationViewModel.Organisations.Where(o => o.Id != Model.ClientInformationSheet.Owner.Id).ToList())
                    {
                        <tr id="@organisation.Id">
                            <td>
                                <button class="btn btn-success btn-sm" onclick="OnClick('Get', 'Organisation', '@organisation.Id', '@Model.ClientInformationSheet.Id', 'OrganisationTab3')"><i class="fa fa-edit"></i> Edit</button>
                            </td>
                            <td>
                                @organisation.Name
                            </td>
                            <td>
                                @organisation.Type
                            </td>
                            <td>
                                @organisation.IsPrincipalAdvisor
                            </td>
                            <td>
                                <button onclick="RemoveLocation('@organisation.Id')" type="button" class=" btn btn-danger btn-sm" id="trash"><span class="fa fa-trash"></span></button>
                            </td>
                        </tr>
                    }
                </tbody>
            </table>
        </div>
        <div id="OrganisationTab2" class="tab-pane" role="tabpanel">
            
        </div>
        <div id="OrganisationTab3" class="tab-pane" role="tabpanel">
            @using (Html.BeginForm("AddOrganisation", "Services", FormMethod.Post, new { @id = "organisationViewModel", @name = "OrganisationViewModel" }))
            {
                @Html.HiddenFor(m => m.ClientInformationSheet.Id)
                @Html.Hidden("ViewModel", "OrganisationViewModel");
                @if (Model.OrganisationViewModel.Programme.Name == "NZFSG Programme")
                {
                    @await Html.PartialAsync("PrefabSections/OrganisationPartials/NZFSG_AddOrganisation", Model)
                    <div class="form-group">
                        <input class="btn btn-success" type="submit" id="OrganisationSubmitBtn" onclick="OnSubmit('organisationViewModel')" value="Add" />
                        <button class="btn btn-danger" id="OrganisationClearButton" onclick="ResetOrganisation('organisationViewModel')"> Clear</button>
                    </div>
                }


            }
            @*<form id="organisationViewModel" name="OrganisationViewModel" action="'@Url.Action("AddOrganisation", "Services")'" method="post">
        </form>*@
        </div>
        <div id="OrganisationTab4" class="tab-pane" role="tabpanel">
            <fieldset>
                <div class="row">
                    <section class="col col-xs-12">
                        <script type="text/javascript">
                                 $(".CommonNamedPartyRemoved").click(function () {
                               $("#tblRemovedCommonNamedParty").jqGrid({
                                url: "/Services/GetDeletedPartners?informationId=@Model.AnswerSheetId&validated=true&removed=true&ceased=false",
                                datatype: "xml",
                                   mtype: "GET",
                                async: true,
                                   colNames: ["","Organisation Name", "Organisation Type"],
                                    colModel: [

                                    {
                                        name: "update", align: 'center' ,width: 60, search: false, formatter: function (cellvalue, options, rowobject) {/*{ class=" btn btn-danger btn-sm"><span class="glyphicon glyphicon-trash*/
                                            return '<button onclick="SetPrincipalRemovedStatus(\'' + cellvalue + '\', \'false\', \'#tblRemovedCommonNamedParty\', \'#CommonNamedParties\');" type="button" class=" btn btn-success btn-sm" ><i class="fa fa-undo"></i></button>';

                                        }
                                    },
                                     { name: "Name", align: 'center' },
                                    { name: "OrganisationType", align: 'center' },
                                   ],
                                autowidth: true,
                                pager: "#CommonRemovedpagerNamedParty",
                                rowNum: 10,
                                rowList: [10, 20, 30],
                                sortname: "Organisation Name",
                                sortorder: "desc",
                                viewrecords: true,
                                gridview: true,
                                autoencode: true
                            });
                            $("#tblRemovedCommonNamedParty").jqGrid('navGrid',
                                '#CommonRemovedpagerNamedParty',
                                { edit: false, add: false, del: false },
                                //options
                                { height: 280, reloadAfterSubmit: false },
                                // edit options
                                { height: 280, reloadAfterSubmit: false },
                                // add options
                                { reloadAfterSubmit: false },
                                // del options
                                { sopt: ['eq', 'bw', 'cn'] }
                                // search options
                                 );
                                });
                        </script>
                        <table id="tblRemovedCommonNamedParty"><tr><td></td></tr></table>
                        <div id="CommonRemovedpagerNamedParty"></div>
                    </section>
                </div>
            </fieldset>
        </div>
    </div>
</div>