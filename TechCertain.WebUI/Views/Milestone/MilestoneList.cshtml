@model TechCertain.WebUI.Models.Milestone.MilestoneListViewModel

<!-- MAIN CONTENT -->
<div id="content">
    <!-- widget grid -->
    <section id="widget-grid" class="">
        <div class="row">
            <article class="col-sm-12 col-md-12 col-lg-6">
                <!-- new widget -->
                <div class="jarviswidget jarviswidget-color-blue" id="wid-id-2"
                     data-widget-editbutton="false" data-widget-colorbutton="false">
                    <header>
                        <span class="widget-icon"> <i class="fa fa-comments txt-color-white"></i> </span>
                        <h2> Milestone Builder - Select Process/Programme </h2>

                    </header>
                    <div>
                        <!-- end widget edit box -->
                        <div class="widget-body widget-hide-overflow no-padding">
                            <!-- content goes here -->
                            <table class="table table-striped table-hover table-condensed">
                                <thead>
                                    <tr>
                                        <th>Milestones</th>
                                        <th>Programme</th>
                                        <th>Active</th>
                                        <th>Actions</th>
                                    </tr>
                                </thead>
                                @foreach (var vm in Model.MilestoneVM)
                                {
                                    <tbody>
                                        <tr>

                                            <td>
                                                @vm.ProgrammeProcess.Name
                                            </td>

                                            <td>
                                                @foreach (var Programme in vm.Programmes)
                                                {
                                                    <select class="form-control b" id="milestoneprogramme" required>
                                                        <option selected="selected" value="">-- Select --</option>
                                                        <option value="@Programme.Id.ToString()"> @Programme.Name</option>
                                                    </select>

                                                }
                                            </td>

                                            <td>
                                                <div class="btn-group btn-group-toggle" data-toggle="buttons">
                                                    <label class="btn btn-secondary active">
                                                        <input type="radio" name="options" id="option1" autocomplete="off" checked="checked"> In Use
                                                    </label>
                                                    <label class="btn btn-secondary">
                                                        <input type="radio" name="options" id="option2" autocomplete="off"> Inactive
                                                    </label>
                                                </div>
                                            </td>

                                            <td>
                                                <a class="btn btn-primary btn-xs" onclick="CreateMilestone('@vm.ProgrammeProcess.Id')">Create/Edit Milestone</a>                                                
                                            </td>

                                        </tr>
                                    </tbody>
                                }
                            </table>
                            <!-- end content -->
                        </div>
                    </div>
                    <!-- end widget div -->
                </div>
                <!-- end widget -->
            </article>
        </div>
    </section>
    <!-- end widget grid -->
</div>

@section pagespecific {
    <script type="text/javascript">

        function Validate(value) {
            if (value != '') {
                return true;
            }
            else {
                return false;
            }
        }

        function CreateMilestone(process) {
            event.preventDefault();
            if (Validate($("#milestoneprogramme").val())) {
                var mergedData = { strProgrammeId: $("#milestoneprogramme").val(), strProgrammeProcessId: process };
                console.log(mergedData);
                debugger;
                $.ajax({
                    url: "/Milestone/MilestoneTemplate",
                    type: "POST",
                    data: mergedData
                })
                   .done(function (url) {

                window.location.href = url;
                console.log("url"+url);
	        })
                    .fail(function (err) {
                        console.log(err);
                        alert("Unable to save." + err.responseText);
                    });
            } else
                alert('Please select a programme');
        }
    </script>
}
