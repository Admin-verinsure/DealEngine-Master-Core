@model TechCertain.WebUI.Models.Milestone.MilestoneListViewModel

<!-- MAIN CONTENT -->
<div id="content" class="container">
    <div class="form-group">
        <span>
            <a class="btn btn-primary btn-xs text-white" onclick="location.href='@Url.Action("Index", "Home")'" id="backbutton"><i class="fa fa-home"></i> Home </a>
        </span>
    </div>
    <div class="form-group">
        <div class="card">
            <div class="card-header">
                <span class="widget-icon">                    
                    <h2><i class="fa fa-comments"></i> Milestone Builder - Select Process/Programme </h2>
                </span>
            </div>
            <div class="card-body">
                <table class="table table-striped table-hover table-condensed">
                    <thead>
                        <tr>
                            <th>Milestones</th>
                            <th>Programme</th>
                            <th>Active</th>
                            <th>Actions</th>
                        </tr>
                    </thead>
                    @foreach (var vm in Model.MilestoneVM)
                    {
                        <tbody>
                            <tr>

                                <td>
                                    @vm.ProgrammeProcess.Name
                                </td>

                                <td>
                                    @foreach (var Programme in vm.Programmes)
                                    {
                                        <select class="form-control b" id="milestoneprogramme" required>
                                            <option selected="selected" value="">-- Select --</option>
                                            <option value="@Programme.Id.ToString()"> @Programme.Name</option>
                                        </select>
                                    }
                                </td>

                                <td>
                                    <div class="btn-group btn-group-toggle" data-toggle="buttons">
                                        <label class="btn btn-secondary active">
                                            <input type="radio" name="options" id="option1" autocomplete="off" checked="checked"> In Use
                                        </label>
                                        <label class="btn btn-secondary">
                                            <input type="radio" name="options" id="option2" autocomplete="off"> Inactive
                                        </label>
                                    </div>
                                </td>

                                <td>
                                    <button class="btn-primary btn" onclick="CreateMilestone('@vm.ProgrammeProcess.Id')">Create/Edit Milestone</button>
                                </td>

                            </tr>
                        </tbody>
                    }
                </table>
            </div>
        </div>
    </div>
</div>

@section pagespecific {
    <script type="text/javascript">

        function Validate(value) {
            if (value != '') {
                return true;
            }
            else {
                return false;
            }
        }

        function CreateMilestone(process) {
            event.preventDefault();
            if (Validate($("#milestoneprogramme").val())) {
                var mergedData = { strProgrammeId: $("#milestoneprogramme").val(), strProgrammeProcessId: process };
                $.ajax({
                    url: "/Milestone/MilestoneTemplate",
                    type: "POST",
                    data: mergedData
                })
                   .done(function (url) {
                window.location.href = url;
	        })
                    .fail(function (err) {
                        console.log(err);
                        alert("Unable to save." + err.responseText);
                    });
            } else
                alert('Please select a programme');
        }
    </script>
}
